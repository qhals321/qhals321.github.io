<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> 우테코 2차 과정 - 3. 지하철 노선도 -다니 </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="지하철 노선도 미션- 우테코 2차 과정 - 3. 지하철 노선도"> <meta name="keywords" content="우테코 2차 과정 - 3. 지하철 노선도, 다니, wua-techcourse,우아한 테크코스, 우형, 우아한 형제들, 배달의 민족, 백앤드, 자바, 2차, 후기, 우아한 테크코스 3기"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="다니" property="og:site_name" /> <meta content="우테코 2차 과정 - 3. 지하철 노선도" property="og:title" /> <meta content="article" property="og:type" /> <meta content="지하철 노선도 미션" property="og:description" /> <meta content="https://qhals321.github.io/blog/wua-2-3/" property="og:url" /> <meta content="2021-01-11T16:35:23+00:00" property="article:published_time" /> <meta content="https://qhals321.github.io/about/" property="article:author" /> <meta content="https://qhals321.github.io/assets/img/posts/techcourse.jpg" property="og:image" /> <meta content="wua-techcourse" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="우테코 2차 과정 - 3. 지하철 노선도" /> <meta name="twitter:url" content="https://qhals321.github.io/blog/wua-2-3/" /> <meta name="twitter:description" content="지하철 노선도 미션" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://qhals321.github.io/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://qhals321.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://qhals321.github.io' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://qhals321.github.io/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://qhals321.github.io/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://qhals321.github.io/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget --> <!-- <script>--> <!-- (function(d, h, m) {--> <!-- var js,--> <!-- fjs = d.getElementsByTagName(h)[0];--> <!-- if (d.getElementById(m)) {--> <!-- return;--> <!-- }--> <!-- js = d.createElement(h);--> <!-- js.id = m;--> <!-- js.onload = function() {--> <!-- window.makerWidgetComInit({--> <!-- position: "left",--> <!-- widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi"--> <!-- });--> <!-- };--> <!-- js.src = "https://makerwidget.com/js/embed.js";--> <!-- fjs.parentNode.insertBefore(js, fjs);--> <!-- })(document, "script", "dhm");--> <!-- </script>--> <!-- buy me a coffeee --> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="https://qhals321.github.io">다니</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://qhals321.github.io/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://qhals321.github.io/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://qhals321.github.io/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item">--> <!-- <a class="nav-link toggle-search-button" href="#search">--> <!-- <i class="fa fa-search search-icon" aria-hidden="true"></i>--> <!-- </a>--> <!-- </li>--> <!-- <li class="nav-item" style="margin-top:5px; padding-right:20px;" >--> <!-- <a class="header__checkout snipcart-checkout">--> <!-- <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg">--> <!-- <path--> <!-- d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z"--> <!-- fill="#ff7901" class="header__checkout-fill"></path>--> <!-- </svg>--> <!-- <span class="snipcart-items-count"></span>--> <!-- &lt;!&ndash; <span class="snipcart-total-price"></span> &ndash;&gt;--> <!-- </a>--> <!-- </li>--> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="col-lg-12"> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">우테코 2차 과정 - 3. 지하철 노선도</h1> <h4 class="post-meta">지하철 노선도 미션</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://qhals321.github.io/blog/authors/Dani">Dani</a></span> </span > at <time datetime="2021-01-11 16:35:23 +0000" itemprop="datePublished" >Jan 11, 2021</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/wua-2-3/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/wua-techcourse" >wua-techcourse</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="https://qhals321.github.io/assets/img/posts/techcourse.jpg" alt="" /> <br /> <br /> <p>드디어 대망의 프리코스의 마지막 과제! 지하철 노선도 과제이다. 역시 마지막 과제는 요구조건이 굉장히 많았다. 요구조건의 대부분은 클린코드를 향해!! 기능 요구사항은 다음과 같다.</p> <p>(깃 주소 : <a href="https://github.com/qhals321/java-subway-map-precourse/blob/bomin/README.md">https://github.com/qhals321/java-subway-map-precourse/blob/bomin/README.md</a>)</p> <ul> <li> <p>기능 요구사항</p> <p><img src="/assets/img/posts/wuatechcourse/tran-map/Untitled.png" height="100%" width="100%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled1.png" height="100%" width="100%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled2.png" height="100%" width="100%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled3.png" height="100%" width="100%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled4.png" height="100%" width="100%" /></p> </li> </ul> <h2 id="-기능-개발-백엔드">🧭 기능 개발 (백엔드)</h2> <hr /> <p>기능 요구사항을 보면 엄청 자세히 나와있다. 예를 들어 역 관련 기능, 노선 관련 기능 이런 식으로 각 도메인 별 요구사항이 자세히 나와있다. 그러다보니 도메인을 나누는 데에 많은 도움이 되었고 나중에 다른 프로젝트를 개발할 때 이런식으로 도메인 별 요구사항을 잘 정리하면 코드를 작성하는 데에 있어 많은 도움이 될 것 같다.</p> <p>기능부터 개발을 시작했다. 클린한 코드를 위해서는 리팩토링이 필수이니 기능 확인 작업을 위한 튼튼한 테스트 코드도 필수였다. (최대한 모든 상황의 수를 테스트 코드로 짜려다 보니 거의 시간의 80%는 테스트 코드를 작성하는 데에 사용이 되었다. 총 31가지 상황의 테스트를 짜게 되었다.)</p> <p>구조는 다음과 같다.</p> <p><img src="/assets/img/posts/wuatechcourse/tran-map/Untitled5.png" height="50%" width="50%" /></p> <p>무언가 기능 구현할 것도 많고 뷰도 많은 내용들이 있다보니 자연스레 MVC 패턴과 같이 코드가 구현되었다. 그리고 복잡한 서비스 로직이 없어서 서비스 레이어는 없이 repository - controller 흐름으로 완성하게 되었다. 이번 과제에서 기능구현은 최대한 유연한 코드가 될 수 있고 안전한 코드가 될 수 있도록 노력했다.</p> <ul> <li> <p>외부 데이터베이스를 사용한다면 어떻게 바로 연결할 수 있을까?</p> <p>= <code class="language-plaintext highlighter-rouge">Repository</code>를 <code class="language-plaintext highlighter-rouge">Interface</code>로 선언해 구현 클래스만 만든다면 바로 연결이 가능하게끔 만들었다.</p> </li> <li> <p>뷰를 어떻게 완벽히 분리할까?</p> <p>= 뷰는 컨트롤러를 통해서만 접근이 가능하게끔 만들었고 도메인의 불변성을 위해 외부(<code class="language-plaintext highlighter-rouge">View</code>)에 내보낼 때는 <code class="language-plaintext highlighter-rouge">DTO</code>로 다시 매핑해서 내보내어 도메인의 불변성을 유지하려 노력했다.</p> </li> </ul> <h3 id="도메인-개발">도메인 개발</h3> <ul> <li> <p><code class="language-plaintext highlighter-rouge">Station</code> (역)</p> <p><code class="language-plaintext highlighter-rouge">Station</code> 도메인을 개발할 때 가장 중요했던 건 <code class="language-plaintext highlighter-rouge">Line</code> 구간에 등록되어 있는 <code class="language-plaintext highlighter-rouge">Station</code>은 삭제가 불가하다는 전제조건이다. <code class="language-plaintext highlighter-rouge">Station</code> 입장에서는 <code class="language-plaintext highlighter-rouge">Line</code>의 모든 것을 알 필요 없이 <code class="language-plaintext highlighter-rouge">Line</code> 구간에 등록이 되어 있느냐만 알면 되니 <code class="language-plaintext highlighter-rouge">int lineCount</code>를 선언해 등록되어 있는 구간의 수를 카운트해주었다. <code class="language-plaintext highlighter-rouge">lineCount</code>가 0이 될 때만 삭제를 허가하면 <code class="language-plaintext highlighter-rouge">Station</code>의 가장 큰 이슈를 해결이 되는 것이다. (여러 구간에 등록이 가능하다, 어찌보면 N : N 관계)</p> <ul> <li> <p>구현 코드</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Station</span> <span class="o">{</span>
      <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">ZERO</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
      <span class="kd">private</span> <span class="kt">int</span> <span class="n">lineCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

      <span class="kd">private</span> <span class="nf">Station</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Station</span> <span class="nf">from</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">){</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nf">Station</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addLine</span><span class="o">()</span> <span class="o">{</span>
          <span class="n">lineCount</span><span class="o">++;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeLine</span><span class="o">()</span> <span class="o">{</span>
          <span class="n">lineCount</span><span class="o">--;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isRemovable</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">lineCount</span> <span class="o">==</span> <span class="no">ZERO</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">o</span><span class="o">)</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">getClass</span><span class="o">()</span> <span class="o">!=</span> <span class="n">o</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
          <span class="nc">Station</span> <span class="n">station</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Station</span><span class="o">)</span> <span class="n">o</span><span class="o">;</span>
          <span class="k">return</span> <span class="nf">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">station</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
      <span class="o">}</span>

      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">hash</span><span class="o">(</span><span class="n">getName</span><span class="o">());</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div> </div> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">Line</code> (노선)</p> <p><code class="language-plaintext highlighter-rouge">Line</code> 도메인 같은 경우 구간까지 관리하게끔 구현했다. 즉, 같은 노선에 있는 역의 정보를 모두 관리하게끔 했다. 구간은 역을 삽입하고 제거하는 기능이 자주 사용이 되니 <code class="language-plaintext highlighter-rouge">LinkedList</code> 자료구조를 사용했다. 구간에 역을 삽입하게 되면 <code class="language-plaintext highlighter-rouge">Station</code>의 <code class="language-plaintext highlighter-rouge">lineCount</code>를 올려주는 메소드를 불러주고, 제거한다면 <code class="language-plaintext highlighter-rouge">lineCount</code>를 내려주는 메소드를 불러오게 되었다. 즉, <code class="language-plaintext highlighter-rouge">Line</code>에서 <code class="language-plaintext highlighter-rouge">Station</code>의 <code class="language-plaintext highlighter-rouge">lineCount</code>에 영향을 주는 방식으로 개발했다.</p> <p>상품 구매 도메인 개발 방식과 매우 유사했다. 고객이 상품을 구매하면 재고 상품의 수는 줄여주고, 구매 취소를 한다면 재고 상품의 수는 다시 늘려준다.</p> <ul> <li> <p>구현 코드</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Line</span> <span class="o">{</span>
      <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">MIN_STATION_SIZE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
      <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Station</span><span class="o">&gt;</span> <span class="n">stations</span><span class="o">;</span>

      <span class="kd">private</span> <span class="nf">Line</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Station</span> <span class="n">start</span><span class="o">,</span> <span class="nc">Station</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
          <span class="n">stations</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;&gt;();</span>
          <span class="n">stations</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">start</span><span class="o">);</span>
          <span class="n">stations</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">end</span><span class="o">);</span>
          <span class="n">start</span><span class="o">.</span><span class="na">addLine</span><span class="o">();</span>
          <span class="n">end</span><span class="o">.</span><span class="na">addLine</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Line</span> <span class="nf">of</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Station</span> <span class="n">start</span><span class="o">,</span> <span class="nc">Station</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nf">Line</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Station</span><span class="o">&gt;</span> <span class="nf">stations</span><span class="o">(){</span>
          <span class="k">return</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">unmodifiableList</span><span class="o">(</span><span class="n">stations</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">joinStation</span><span class="o">(</span><span class="nc">Station</span> <span class="n">station</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">int</span> <span class="n">newIndex</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>   <span class="c1">//1을 입력하면 0 번째 인덱스를 가르킨다.</span>
          <span class="n">stations</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">newIndex</span><span class="o">,</span> <span class="n">station</span><span class="o">);</span>
          <span class="n">station</span><span class="o">.</span><span class="na">addLine</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isCorrectIndex</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">int</span> <span class="n">minIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
          <span class="kt">int</span> <span class="n">maxIndex</span> <span class="o">=</span> <span class="n">stations</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
          <span class="k">return</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">minIndex</span> <span class="o">&amp;&amp;</span> <span class="n">index</span> <span class="o">&lt;=</span> <span class="n">maxIndex</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeStation</span><span class="o">(</span><span class="nc">Station</span> <span class="n">station</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">stations</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">station</span><span class="o">);</span>
          <span class="n">station</span><span class="o">.</span><span class="na">removeLine</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isStationRemovable</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">stations</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="no">MIN_STATION_SIZE</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">stationSize</span><span class="o">(){</span>
          <span class="k">return</span> <span class="n">stations</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">containsStation</span><span class="o">(</span><span class="nc">Station</span> <span class="n">station</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">stations</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">station</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeAllStation</span><span class="o">(){</span>
          <span class="n">stations</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nl">Station:</span><span class="o">:</span><span class="n">removeLine</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">o</span><span class="o">)</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">getClass</span><span class="o">()</span> <span class="o">!=</span> <span class="n">o</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
          <span class="nc">Line</span> <span class="n">line</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Line</span><span class="o">)</span> <span class="n">o</span><span class="o">;</span>
          <span class="k">return</span> <span class="nf">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
      <span class="o">}</span>

      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">hash</span><span class="o">(</span><span class="n">getName</span><span class="o">());</span>
      <span class="o">}</span>
  <span class="o">}</span>

</code></pre></div> </div> </li> </ul> </li> </ul> <h3 id="repository-개발">Repository 개발</h3> <p>도메인의 상태관리를 해준다. 이번 과제들을 통해 repository에 대한 정의가 정확히 세워진 것 같다.</p> <p>과제에서 기본 뼈대가 있었는데 흥미로웠던 건 <code class="language-plaintext highlighter-rouge">Collections.unmodifiableList(lines)</code> 라는 메소드였다. 이런식으로 배열의 불변성을 유지할 수 있구나..!! 하지만 테스트 코드를 짤 때 저장되어 있는 모든 도메인을 삭제해야했기 때문에 새로운 배열에 옮겨 담아줬다. <code class="language-plaintext highlighter-rouge">new ArrayList(lines)&lt;&gt;</code>.</p> <p>만일 자바 내부에서 데이터를 관리하는 것이 아니라 외부 데이터베이스를 사용해 관리한다면, <code class="language-plaintext highlighter-rouge">Repository</code>가 바뀌어야했기에 <code class="language-plaintext highlighter-rouge">Repository</code>는 인터페이스로 선언하고 <code class="language-plaintext highlighter-rouge">RepositoryJava</code>로 코드를 구현하게 되었다.</p> <h3 id="controller-개발">Controller 개발</h3> <p>유효성 검사에 대해 고민이 많았다. 도메인 모델에서 검사를 하는 것이 맞을까 뷰에 가까운 컨트롤러에서 검사를 하는 것이 적합할까? 어디서 얼핏 봤던 건 ‘뷰에서 들어오자마자 유효성부터 검사를 하는 것이 좋다’해서 컨트롤러에서 검사하는 방법을 선택했다. 컨트롤러가 하는 역할은 유효성 검사와 요청에 맞는 데이터 반환이다.</p> <p>데이터 반환 같은 경우 최대한 뷰와 도메인의 의존을 줄이기 위해 새로운 <code class="language-plaintext highlighter-rouge">DTO</code>를 만들어 제공해주었다. 도메인의 불변성을 위해…!</p> <h2 id="-view-개발">🧭 View 개발</h2> <hr /> <p>가장 공을 들였던 시간이다. ‘if else 또는 switch 사용이 불가하다’라는 요구사항이 있어, ‘어떤 방식으로 사용자에게 입력에 맞는 출력을 내뱉을 수 있을까?’ 고민을 했다. 방법은 <code class="language-plaintext highlighter-rouge">Map</code>을 이용해 사용자가 입력하는 글자를 <code class="language-plaintext highlighter-rouge">key</code>로 만들고 그에 맞는 화면을 <code class="language-plaintext highlighter-rouge">value</code>로 넣었다.</p> <h3 id="navigation-view">Navigation View</h3> <p>사용자가 입력해 그에 맞는 화면으로 이동하는 뷰를 <code class="language-plaintext highlighter-rouge">navigationView</code> 폴더를 만들어 관리했다.</p> <p><img src="/assets/img/posts/wuatechcourse/tran-map/Untitled6.png" height="50%" width="50%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled7.png" height="50%" width="50%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled8.png" height="50%" width="50%" /> <img src="/assets/img/posts/wuatechcourse/tran-map/Untitled9.png" height="50%" width="50%" /></p> <p>총 4가지의 화면이 존재했다. 이 화면들은 전부 보기를 주어서 선택하면 그에 맞는 서비스를 제공해주는 뷰라 <code class="language-plaintext highlighter-rouge">navigationView</code> 라는 관심으로 묶었다. 디테일한 부분만 다르고 기능은 모두 같기 때문에 템플릿 메소드 패턴을 이용했다. (enum으로도 처리할까 고민하다가 이번에는 템플릿 메소드 패턴을 사용해보고 싶다는 마음에…)</p> <p><code class="language-plaintext highlighter-rouge">NavigationViewTemplate</code>이라는 추상 클래스를 만들어 디테일한 부분은 상속받은 클래스에서 구현하게끔 만들어 코드를 동작하게 만든다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">NavigationViewTemplate</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">Scanner</span> <span class="n">scanner</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ViewsContainer</span> <span class="n">views</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="nc">ViewStrategy</span> <span class="n">viewStrategy</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NavigationViewTemplate</span><span class="o">(</span><span class="nc">Scanner</span> <span class="n">scanner</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">scanner</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">views</span> <span class="o">=</span> <span class="n">setViewsContainer</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">//선택 사항의 뷰를 담는 컨테이너를 구현하게끔 한다.</span>
    <span class="kd">protected</span> <span class="kd">abstract</span> <span class="nc">ViewsContainer</span> <span class="nf">setViewsContainer</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">show</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">selectView</span><span class="o">();</span>
        <span class="n">viewStrategy</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
        <span class="nc">OutputView</span><span class="o">.</span><span class="na">enter</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">selectView</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">OutputView</span><span class="o">.</span><span class="na">selectView</span><span class="o">(</span><span class="n">navViewName</span><span class="o">());</span>
        <span class="nc">OutputView</span><span class="o">.</span><span class="na">printMessage</span><span class="o">(</span><span class="n">views</span><span class="o">.</span><span class="na">navigate</span><span class="o">());</span>
        <span class="nc">String</span> <span class="n">viewKey</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
        <span class="n">viewStrategy</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="na">getView</span><span class="o">(</span><span class="n">viewKey</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">viewStrategy</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">OutputView</span><span class="o">.</span><span class="na">notExist</span><span class="o">();</span>
            <span class="n">selectView</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">//화면의 이름을 리턴하게 한다. (예 : 메인화면)</span>
    <span class="kd">protected</span> <span class="kd">abstract</span> <span class="nc">String</span> <span class="nf">navViewName</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div> <p>상속을 받는다면 뷰 컨테이너 완성과 화면의 이름만 구현하면 된다.</p> <p>뷰 컨테이너란 메인화면을 예로 든다면</p> <ol> <li>역 관리</li> <li>노선 관리</li> <li>구간 관리</li> <li>지하철 노선도 출력</li> </ol> <p>Q. 종료</p> <p>위의 각 뷰를 담은 컨테이너다. (<code class="language-plaintext highlighter-rouge">{key : 1, value : '역 관리 뷰'}</code>)</p> <p>다음이 메인화면의 구현 코드이다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainView</span> <span class="kd">extends</span> <span class="nc">NavigationViewTemplate</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">NAV_VIEW_NAME</span> <span class="o">=</span> <span class="s">"메인 화면"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MainView</span><span class="o">(</span><span class="nc">Scanner</span> <span class="n">scanner</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">scanner</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">show</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
        <span class="c1">//종료를 선택하지 않는다면 다시 메인화면을 띄워줄 수 있게 한다.</span>
        <span class="k">if</span><span class="o">(!(</span><span class="n">viewStrategy</span> <span class="k">instanceof</span> <span class="nc">ExitView</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">show</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">ViewsContainer</span> <span class="nf">setViewsContainer</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ViewsContainer</span> <span class="n">views</span> <span class="o">=</span> <span class="nc">ViewsContainer</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
        <span class="n">views</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">StationManageView</span><span class="o">(</span><span class="n">scanner</span><span class="o">));</span>
        <span class="n">views</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"2"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LineManageView</span><span class="o">(</span><span class="n">scanner</span><span class="o">));</span>
        <span class="n">views</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"3"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LineStationManageView</span><span class="o">(</span><span class="n">scanner</span><span class="o">));</span>
        <span class="n">views</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"4"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LineMapView</span><span class="o">());</span>
        <span class="n">views</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Q"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">ExitView</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">views</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="nf">navViewName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">NAV_VIEW_NAME</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p>메인화면은 <code class="language-plaintext highlighter-rouge">exit</code>을 누르지 않는 이상 계속 반복을 시켜줘야해서 <code class="language-plaintext highlighter-rouge">show()</code>를 오버라이딩을 해 위 코드를 더했다.</p> <ul> <li> <p>enum 버전</p> <p>enum 이 더 깔끔한 것 같기도 하고…?</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">enum</span> <span class="nc">MainView</span> <span class="o">{</span>
      <span class="no">ONE</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="s">"역 관리"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">StationManageStr</span><span class="o">()),</span>
      <span class="no">TWO</span><span class="o">(</span><span class="s">"2"</span><span class="o">,</span> <span class="s">"노선 관리"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LineManageStr</span><span class="o">()),</span>
      <span class="no">THREE</span><span class="o">(</span><span class="s">"3"</span><span class="o">,</span> <span class="s">"구간 관리"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">StationLineManageStr</span><span class="o">()),</span>
      <span class="no">FOUR</span><span class="o">(</span><span class="s">"4"</span><span class="o">,</span> <span class="s">"지하철 노선도 출력"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LinePrinterStr</span><span class="o">()),</span>
      <span class="no">QUIT</span><span class="o">(</span><span class="s">"Q"</span><span class="o">,</span> <span class="s">"종료"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>

      <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MENU_FORM</span> <span class="o">=</span> <span class="s">"%s. %s \n"</span><span class="o">;</span>
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">inputNum</span><span class="o">;</span>
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">viewName</span><span class="o">;</span>
      <span class="kd">private</span> <span class="nc">View2Strategy</span> <span class="n">view2Strategy</span><span class="o">;</span>

      <span class="nc">MainView</span><span class="o">(</span><span class="nc">String</span> <span class="n">inputNum</span><span class="o">,</span> <span class="nc">String</span> <span class="n">viewName</span><span class="o">,</span> <span class="nc">View2Strategy</span> <span class="n">view2Strategy</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">inputNum</span> <span class="o">=</span> <span class="n">inputNum</span><span class="o">;</span>
          <span class="k">this</span><span class="o">.</span><span class="na">viewName</span> <span class="o">=</span> <span class="n">viewName</span><span class="o">;</span>
          <span class="k">this</span><span class="o">.</span><span class="na">view2Strategy</span> <span class="o">=</span> <span class="n">view2Strategy</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">menuList</span><span class="o">()</span> <span class="o">{</span>
          <span class="nc">StringBuilder</span> <span class="n">menu</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
          <span class="k">for</span> <span class="o">(</span><span class="nc">MainView</span> <span class="n">value</span> <span class="o">:</span> <span class="n">values</span><span class="o">())</span> <span class="o">{</span>
              <span class="n">menu</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="no">MENU_FORM</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">inputNum</span><span class="o">,</span> <span class="n">value</span><span class="o">.</span><span class="na">viewName</span><span class="o">));</span>
          <span class="o">}</span>
          <span class="k">return</span> <span class="n">menu</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="nc">String</span> <span class="n">inputNum</span><span class="o">)</span> <span class="o">{</span>
          <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">values</span><span class="o">())</span>
                  <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">value</span> <span class="o">-&gt;</span> <span class="n">value</span><span class="o">.</span><span class="na">inputNum</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">inputNum</span><span class="o">))</span>
                  <span class="o">.</span><span class="na">findFirst</span><span class="o">()</span>
                  <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">IllegalStateException</span><span class="o">(</span><span class="s">""</span><span class="o">))</span>
                  <span class="o">.</span><span class="na">view2Strategy</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div> </div> </li> </ul> <h3 id="execute-views">Execute Views</h3> <p>실제로 기능을 실행하는 뷰들이다. <code class="language-plaintext highlighter-rouge">View Container</code>에 들어가는 <code class="language-plaintext highlighter-rouge">value</code>들이기도 하다. 위 <code class="language-plaintext highlighter-rouge">navigation view</code>에서 입력하는 <code class="language-plaintext highlighter-rouge">key</code>에 따라 각자 다르게 실행할 수 있게 만들어야 했기 때문에 <code class="language-plaintext highlighter-rouge">Strategy pattern</code>을 이용했다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ViewStrategy</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">execute</span><span class="o">();</span>
    <span class="nc">String</span> <span class="nf">viewName</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">View Container</code>에서 <code class="language-plaintext highlighter-rouge">value</code>로 들어가는 인터페이스다. <code class="language-plaintext highlighter-rouge">execute()</code>는 <code class="language-plaintext highlighter-rouge">navigation view</code>에서 클릭을 했을 시 실행될 구간이다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="nc">NavigationViewTemplate</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">show</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">selectView</span><span class="o">();</span>
        <span class="n">viewStrategy</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
        <span class="nc">OutputView</span><span class="o">.</span><span class="na">enter</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div></div> <p>위를 보면 <code class="language-plaintext highlighter-rouge">show()</code>라는 함수가 실행이 되면 <code class="language-plaintext highlighter-rouge">execute()</code> 함수가 실행이 되는 것을 볼 수 있다. 즉, 선택한 키에 맞는 뷰의 <code class="language-plaintext highlighter-rouge">execute()</code> 함수가 실행되게끔 만들었다.</p> <p>역을 만드는 기능을 갖고 있는 화면을 실행하는 코드이다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CreateStationView</span> <span class="kd">implements</span> <span class="nc">ViewStrategy</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">VIEW_NAME</span> <span class="o">=</span> <span class="s">"역 등록"</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CREATE_MESSAGE</span> <span class="o">=</span> <span class="s">"등록할 역 이름을 입력하세요."</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CREATE_COMPLETE</span> <span class="o">=</span> <span class="s">"지하철 역이 등록되었습니다."</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">StationController</span> <span class="n">stationController</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Scanner</span> <span class="n">scanner</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CreateStationView</span><span class="o">(</span><span class="nc">StationController</span> <span class="n">stationController</span><span class="o">,</span> <span class="nc">Scanner</span> <span class="n">scanner</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">stationController</span> <span class="o">=</span> <span class="n">stationController</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">scanner</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">OutputView</span><span class="o">.</span><span class="na">selectView</span><span class="o">(</span><span class="no">CREATE_MESSAGE</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">stationName</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
            <span class="nc">OutputView</span><span class="o">.</span><span class="na">enter</span><span class="o">();</span>
            <span class="n">stationController</span><span class="o">.</span><span class="na">createStation</span><span class="o">(</span><span class="n">stationName</span><span class="o">);</span>
            <span class="nc">OutputView</span><span class="o">.</span><span class="na">infoView</span><span class="o">(</span><span class="no">CREATE_COMPLETE</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalStateException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">OutputView</span><span class="o">.</span><span class="na">errorView</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">viewName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">VIEW_NAME</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h2 id="--이번-과제를-끝내며">🧭 이번 과제를 끝내며…</h2> <p>이번 과제에서는 저번 과제에서 힘썼던 ‘역할 분담’ 이외에도 ‘유지보수’를 고려하며 코드를 작성하려 노력했다.</p> <ul> <li>만약 외부 데이터베이스와 연동하고 싶다면?</li> <li>기능을 추가해야되는데 다른 코드를 건들지 않고 개발을 어떻게 할까?</li> <li>만약 외부에서 데이터 조작이 생긴다면? (불변성 유지)</li> </ul> <p>이런 고민을 하며 코드를 작성하다보니 자연스레 디자인 패턴을 사용하면서 추상 클래스와 인터페이스가 작성이 되었다.</p> <p>또한 <code class="language-plaintext highlighter-rouge">switch</code>문과 <code class="language-plaintext highlighter-rouge">else</code>문 없이 다양한 요청을 어떻게 처리할까가 가장 고민이었다. 원래대로라면 <code class="language-plaintext highlighter-rouge">switch</code>문을 쓰겠지만 다른 방법으로 접근해보니 고민스러웠지만 너무 재미있던 시간이었다. 자연스레 코드가 조금 더 객체지향적인 코드가 되었고 유지보수 측면에서도 더 좋은 코드가 나오게 되었다.</p> <p>확실히 뷰와 기능개발을 정확히 나누어 개발을 하다보니 정말 편했다. 기능 개발을 할 때에는 뷰에 내보낼 데이터만 생각하고 그에 맞는 테스트 코드를 작성하니 테스트 코드만 잘 돌아간다면 어떤 리팩토링을 해도 뷰에는 영향을 주지 않아 독립적인 개발이 가능했다. 이렇게 프론트앤드와 백앤드가 나눠졌구나..!</p> <p>이번 과제에도 정말 많은 것을 배웠다. 기능 구현 부분에서는 백앤드 웹 개발과 비슷했지만 콘솔 뷰 구현 부분은 새로운 도전이라 많은 고민을 던져주었고 그 속에서 다시 한 번 성장한 것 같다. 이번 과제가 프리코스 마지막이라니 조금은 아쉽긴하다…</p> <h2 id="---아쉬운-점-20201217-추가">🧭 아쉬운 점 (2020.12.17 추가)</h2> <p>오브젝트 책을 과제가 끝나고 다 읽어봤다. 내가 낸 과제에는 아쉬운 점들이 몇몇 있었다.</p> <ol> <li> <p>예외처리</p> <p>예외를 던지는 곳을 컨트롤러 부분에서 다 던지게 되었다. 하지만 객체지향(책임주도개발)은 한 객체가 행동을 했을 때 생기는 모든 것은 그 객체만 알아야 하는데 외부에서 예외까지 던져주면 그 외부는 그 객체가 어떻게 흘러가야되는 지 알아야 되므로 SRP 법칙에 어긋나는 것 같다.</p> <p>예외는 생기는 곳에서 바로 throw!!!</p> </li> <li> <p>상속 보다는 합성</p> <p>뷰 템플릿이라는 추상 클래스를 만들어 그것을 상속받아 뷰를 확장시켰다(템플릿 메소드 패턴). 그러면서 super의 메서드를 호출했는데 그렇게되면 상위 클래스와 의존성이 깊어지는 것이다. 과연 유지보수에 알맞은 코드일까?? 차라리 상속보다는 자식 객체마다 바뀌어지는 부분을 클래스로 만들어 합성 방식을 사용했으면 어떠했을까?</p> </li> <li> <p>너무 MVC 패턴의 의존</p> <p>추상화가 부족했던 것 같다. 1,2 차 과제는 최대한 추상화를 하려고 노력했는데 이번 과제에는 MVC만을 신경쓴 것 같다. 네이밍같은 경우 편했지만 객체들끼리의 연결을 잘 만들어주지 못 한 것 같다. 도메인끼리 연결해서 만들려고 노력하자.</p> </li> </ol> <p>이 책을 조금 더 빨리 발견했더라면 객체지향의 베이스를 조금 더 탄탄히 했을텐데 아쉬웠다. 그래도 파이널 테스트 이전에 발견하고 고칠 수 있어서 정말 다행이다.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="https://qhals321.github.io/blog/wua-2-3/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Dani </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://qhals321.github.io/assets/img/authors/Dani.png" alt="Dani" /> </div> <div class="col-md-6"> <p class="author_bio">많은 것을 배우고 싶은 사람</p> <p>Email : bomdani9302@gmail.com</p> <p>Website : https://qhals321.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/qhals321" target="_blank"><i class="fab fa-github fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "https://qhals321.github.io/blog/wua-2-3/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/프리코스-2차-지하철노선도"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About 다니</div> <div class="card-body"> <p class="author_bio">많은 것을 배우고 나누고싶은 사람</p><!-- Place this tag where you want the github button to render. --> <!--<a class="github-button" href="https://github.com/qhals321" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a>--> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#wua-techcourse"></div> <li class="tag-head"> <a href="/blog/categories/wua-techcourse">wua-techcourse</a> </li> <a name="wua-techcourse"></a> <div id="#java-basic"></div> <li class="tag-head"> <a href="/blog/categories/java-basic">java-basic</a> </li> <a name="java-basic"></a> <div id="#programming-etc"></div> <li class="tag-head"> <a href="/blog/categories/programming-etc">programming-etc</a> </li> <a name="programming-etc"></a> <div id="#book-review"></div> <li class="tag-head"> <a href="/blog/categories/book-review">book-review</a> </li> <a name="book-review"></a> <div id="#http"></div> <li class="tag-head"> <a href="/blog/categories/http">http</a> </li> <a name="http"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://qhals321.github.io/">Home</a> </li> <li> <a href="https://qhals321.github.io/about">About</a> </li> <li> <a href="https://qhals321.github.io/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <!--<form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>--> <!--<div id="mc_embed_signup_scroll_footer">--> <!-- <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label>--> <!-- <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required>--> <!-- &lt;!&ndash; real people should not fill this in and expect good things - do not remove this or risk form bot signups&ndash;&gt;--> <!-- <div style="position: absolute; left: -5000px;" aria-hidden="true">--> <!-- <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value="">--> <!-- </div><br />--> <!-- <div class="clear">--> <!-- <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success">--> <!-- </div>--> <!--</div>--> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://qhals321.github.io/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
