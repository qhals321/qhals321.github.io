<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> 자바 기본 - 스트림 -다니 </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="스트림이란?- 자바 기본 - 스트림"> <meta name="keywords" content="자바 기본 - 스트림, 다니, java-basic,자바, 기본, 스트림, 자바8"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="다니" property="og:site_name" /> <meta content="자바 기본 - 스트림" property="og:title" /> <meta content="article" property="og:type" /> <meta content="스트림이란?" property="og:description" /> <meta content="https://qhals321.github.io/blog/java-basic/stream/" property="og:url" /> <meta content="2021-01-13T16:35:23+00:00" property="article:published_time" /> <meta content="https://qhals321.github.io/about/" property="article:author" /> <meta content="https://qhals321.github.io/assets/img/posts/java-basic-img/java-basic.jpg" property="og:image" /> <meta content="java-basic" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="자바 기본 - 스트림" /> <meta name="twitter:url" content="https://qhals321.github.io/blog/java-basic/stream/" /> <meta name="twitter:description" content="스트림이란?" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://qhals321.github.io/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://qhals321.github.io/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://qhals321.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://qhals321.github.io' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://qhals321.github.io/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://qhals321.github.io/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://qhals321.github.io/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://qhals321.github.io/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget --> <!-- <script>--> <!-- (function(d, h, m) {--> <!-- var js,--> <!-- fjs = d.getElementsByTagName(h)[0];--> <!-- if (d.getElementById(m)) {--> <!-- return;--> <!-- }--> <!-- js = d.createElement(h);--> <!-- js.id = m;--> <!-- js.onload = function() {--> <!-- window.makerWidgetComInit({--> <!-- position: "left",--> <!-- widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi"--> <!-- });--> <!-- };--> <!-- js.src = "https://makerwidget.com/js/embed.js";--> <!-- fjs.parentNode.insertBefore(js, fjs);--> <!-- })(document, "script", "dhm");--> <!-- </script>--> <!-- buy me a coffeee --> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="https://qhals321.github.io">다니</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://qhals321.github.io/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://qhals321.github.io/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://qhals321.github.io/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item">--> <!-- <a class="nav-link toggle-search-button" href="#search">--> <!-- <i class="fa fa-search search-icon" aria-hidden="true"></i>--> <!-- </a>--> <!-- </li>--> <!-- <li class="nav-item" style="margin-top:5px; padding-right:20px;" >--> <!-- <a class="header__checkout snipcart-checkout">--> <!-- <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg">--> <!-- <path--> <!-- d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z"--> <!-- fill="#ff7901" class="header__checkout-fill"></path>--> <!-- </svg>--> <!-- <span class="snipcart-items-count"></span>--> <!-- &lt;!&ndash; <span class="snipcart-total-price"></span> &ndash;&gt;--> <!-- </a>--> <!-- </li>--> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="col-lg-12"> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">자바 기본 - 스트림</h1> <h4 class="post-meta">스트림이란?</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://qhals321.github.io/blog/authors/Dani">Dani</a></span> </span > at <time datetime="2021-01-13 16:35:23 +0000" itemprop="datePublished" >Jan 13, 2021</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/java-basic/stream/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/java-basic" >java-basic</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="https://qhals321.github.io/assets/img/posts/java-basic-img/java-basic.jpg" alt="" /> <br /> <br /> <h2 id="스트림이란">스트림이란?</h2> <ul> <li>컬렉션(배열 포함)의 요소를 하나씩 참조해서 람다식으로 처리할 수 있는 반복자.</li> <li>병렬처리도 쉽게 가능하기 때문에(내부 반복자 이용) 편리하다. <ul> <li>병렬처리는 한가지 작업을 서브 작업으로 나눠서 분리되어서 처리하는 방식. (parallel만 붙이면 된다.)</li> </ul> </li> <li>오리지날 스트림 → (필터링 처리) 중간 스트림 → (매핑 처리) 중간 스트림 → 집계 처리 결과물</li> </ul> <p><a href="https://www.notion.so/2e3942c7df754531aee05105e1dcd687">스트림 종류</a></p> <p><a href="https://www.notion.so/23e7fa8179df4e0386bae6548f08cc2b">Reduction</a></p> <h2 id="collectors-기능">Collectors 기능</h2> <ul> <li>스트림 요소를 하나의 값으로 리듀스하고 요약</li> <li>요소 그룹화</li> <li>요소 분할</li> </ul> <h3 id="reducing-and-summarize">Reducing and Summarize</h3> <hr /> <ul> <li><code class="language-plaintext highlighter-rouge">collect(Collectors.counting())</code> → <code class="language-plaintext highlighter-rouge">stream().count()</code> 로 변경 가능</li> <li><code class="language-plaintext highlighter-rouge">collect(summingInt(~~~))</code> 값 더하기</li> <li><code class="language-plaintext highlighter-rouge">collect(averagingInt(~~~))</code> 값 평균</li> <li><code class="language-plaintext highlighter-rouge">collect(summarizingInt(~~~))</code> 모든 정보 수집</li> <li><code class="language-plaintext highlighter-rouge">collect(joining(", "))</code> 문자열 합치기</li> <li> <p><code class="language-plaintext highlighter-rouge">collect(reducing(0, Student::getScore, (i, j) -&gt; i+j))</code></p> <p>여기서 <code class="language-plaintext highlighter-rouge">reduce()</code> 를 바로 사용하는 것과 <code class="language-plaintext highlighter-rouge">collect()</code> 를 이용하는 리듀싱에는 어떤 점이 차이가 있을까?</p> <p><code class="language-plaintext highlighter-rouge">collect</code> 메서드는 도출하려는 결과를 누적하는 컨테이너를 바꾸도록 설계된 메서드인 반면 <code class="language-plaintext highlighter-rouge">reduce</code> 는 두 값을 하나로 도출하는 불변형 연산이라는 점에서 의미론적인 문제가 일어난다. 여러 스레드가 동시에 같은 데이터 구조체를 고치면 리스트 자체가 망가져버리므로 리듀싱 연산을 병렬로 수행할 수 없다는 것이 문제인데 이 문제를 해결하려면 매번 새로운 리스트를 할당하는 방법으로 해야하는데 그러기에는 성능이 너무 좋지 않다. 이럴 때는 <code class="language-plaintext highlighter-rouge">collect()</code> 를 사용하자!</p> <p>이런 방법도 가능 !! <code class="language-plaintext highlighter-rouge">collect(reducing(0, Student::getScore, Integer::sum))</code></p> </li> </ul> <p>여기서 만약 그냥 학생의 성적의 합만 계산한다면 <code class="language-plaintext highlighter-rouge">students.stream().mapToInt(Student::getScore).sum()</code> 이 가장 가독성도 좋고 자동 언박싱 과정을 피할 수 있으므로 성능도 제일 좋다. 상황에 맞추어 메서드를 사용하자!</p> <h3 id="grouping-분류-함수">Grouping (분류 함수)</h3> <hr /> <p>개인적으로 제일 좋아하는 Collectors의 기능! 사용법 : <code class="language-plaintext highlighter-rouge">collect(groupingBy(Student::getClass))</code></p> <p>enum으로 그루핑하고 싶다면 다음 방법도 가능하다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Grade</span> <span class="o">{</span>
    <span class="no">A</span><span class="o">(</span><span class="n">score</span> <span class="o">-&gt;</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">95</span><span class="o">),</span>
    <span class="no">B</span><span class="o">(</span><span class="n">score</span> <span class="o">-&gt;</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="o">),</span>
    <span class="no">C</span><span class="o">(</span><span class="n">score</span> <span class="o">-&gt;</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="o">),</span>
    <span class="no">D</span><span class="o">(</span><span class="n">score</span> <span class="o">-&gt;</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="o">),</span>
    <span class="no">F</span><span class="o">(</span><span class="n">score</span> <span class="o">-&gt;</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="mi">70</span><span class="o">);</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Predicate</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">predicate</span><span class="o">;</span>

    <span class="nc">Grade</span><span class="o">(</span><span class="nc">Predicate</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">predicate</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">predicate</span> <span class="o">=</span> <span class="n">predicate</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Grade</span> <span class="nf">getGradeByScore</span><span class="o">(</span><span class="kt">int</span> <span class="n">score</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">values</span><span class="o">())</span>
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">value</span> <span class="o">-&gt;</span> <span class="n">value</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">score</span><span class="o">))</span>
                <span class="o">.</span><span class="na">findFirst</span><span class="o">()</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">IllegalStateException</span><span class="o">(</span><span class="s">"wrong input"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">execute</span><span class="o">(</span><span class="kt">int</span> <span class="n">score</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">predicate</span><span class="o">.</span><span class="na">test</span><span class="o">(</span><span class="n">score</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Grade</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Student</span><span class="o">&gt;&gt;</span> <span class="n">collect</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span><span class="n">student</span> <span class="o">-&gt;</span> <span class="nc">Grade</span><span class="o">.</span><span class="na">getGradeByScore</span><span class="o">(</span><span class="n">student</span><span class="o">.</span><span class="na">getScore</span><span class="o">())));</span>
    <span class="o">}</span>
</code></pre></div></div> <p>그렇다면 두 가지 이상의 기준을 동시에 적용할 수 있을까?</p> <p><strong>다수준 그룹화</strong></p> <p><code class="language-plaintext highlighter-rouge">Collectors.groupingBy</code> 는 일반적으로 분류 함수와 컬렉터를 인수로 받는다. 즉 컬렉터 인수에 다시 한 번 <code class="language-plaintext highlighter-rouge">grouping</code> 을 사용한다면 다수준 그룹화가 가능하다.</p> <p><strong>서브그룹으로 데이터 수집</strong></p> <p><code class="language-plaintext highlighter-rouge">Collectors.groupingBy</code> 의 두 번째 인수는 컬렉터를 받는다 했다. 그러면 각 인원의 수를 넣으려면 어떻게 할까? 다음과 같다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Grade</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="n">collect1</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span><span class="n">student</span> <span class="o">-&gt;</span> <span class="nc">Grade</span><span class="o">.</span><span class="na">getGradeByScore</span><span class="o">(</span><span class="n">student</span><span class="o">.</span><span class="na">getScore</span><span class="o">()),</span> <span class="nc">Collectors</span><span class="o">.</span><span class="na">counting</span><span class="o">()));</span>
</code></pre></div></div> <p>그렇다면 가장 스코어가 높은 사람의 이름을 넣고 싶다면 어떻게 할까?</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">students</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span><span class="n">student</span> <span class="o">-&gt;</span> <span class="nc">Grade</span><span class="o">.</span><span class="na">getGradeByScore</span><span class="o">(</span><span class="n">student</span><span class="o">.</span><span class="na">getScore</span><span class="o">()),</span>
                                                          <span class="nc">Collectors</span><span class="o">.</span><span class="na">maxBy</span><span class="o">(</span><span class="nc">Comparator</span><span class="o">.</span><span class="na">comparingInt</span><span class="o">(</span><span class="nl">Student:</span><span class="o">:</span><span class="n">getScore</span><span class="o">))));</span>
</code></pre></div></div> <p>위와 같이 하면 Optional로 값이 다 감싸져 있을 것이다. 변환 함수도 같이 넣어줘야 하는데 그럴 때는 <code class="language-plaintext highlighter-rouge">collectingAndThen()</code> 함수를 사용하면 된다. 다음은 Optional까지 변환한 코드이다.</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Grade</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">collect2</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span><span class="n">student</span> <span class="o">-&gt;</span> <span class="nc">Grade</span><span class="o">.</span><span class="na">getGradeByScore</span><span class="o">(</span><span class="n">student</span><span class="o">.</span><span class="na">getScore</span><span class="o">()),</span>
                        <span class="nc">Collectors</span><span class="o">.</span><span class="na">collectingAndThen</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">maxBy</span><span class="o">(</span><span class="nc">Comparator</span><span class="o">.</span><span class="na">comparingInt</span><span class="o">(</span><span class="nl">Student:</span><span class="o">:</span><span class="n">getScore</span><span class="o">)),</span> <span class="n">opt</span> <span class="o">-&gt;</span> <span class="n">opt</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getName</span><span class="o">())));</span>
</code></pre></div></div> <p>이외에도 두 번째 인수에는 mapping도 가능하다.</p> <h3 id="partition분할">partition(분할)</h3> <hr /> <p>분할 함수는 <code class="language-plaintext highlighter-rouge">Collectors.partitioningBy()</code> 함수를 사용한다. boolean값으로만 키가 나눠지고 결국 true or false 의 키만 가질 수 있다는 것이다. 사용 방법은 그루핑 하는 방법과 같다.</p> <h3 id="collectors-사용">Collectors 사용</h3> <p>정적 메소드 사용 : Collectors.toList(), Collectors.toMap(), Collectors.toSet(), Collectors.toConcurrentMap(), Collectors.toCollection(Supplier<T>)</T></p> <ul> <li> <p>collect custom 방법</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">stream</span><span class="o">()</span>
  	<span class="o">.</span><span class="na">collect</span><span class="o">(</span>
  		<span class="o">()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">Container</span><span class="o">(),</span>
  		<span class="o">(</span><span class="n">r</span><span class="o">,</span><span class="n">t</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">r</span><span class="o">.</span><span class="na">accumulate</span><span class="o">(</span><span class="n">t</span><span class="o">),</span> <span class="c1">//r= 컨테이너, t=각 요소</span>
  		<span class="o">(</span><span class="n">r1</span><span class="o">,</span> <span class="n">r2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">r1</span><span class="o">.</span><span class="na">combine</span><span class="o">(</span><span class="n">r2</span><span class="o">));</span> <span class="c1">//마지막은 combine, 없어도 됨 싱글스레드는</span>
</code></pre></div> </div> </li> <li> <p>Collectors.groupingBy() 도 사용가능 (groupingByConcurrent()는 스레드 세이프한 맵)</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">stream</span><span class="o">()</span>
  	<span class="o">.</span><span class="na">collect</span><span class="o">(</span>
  		<span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span>
  			<span class="nl">Student:</span><span class="o">:</span><span class="n">getCity</span><span class="o">,</span> <span class="c1">//키가 될 값</span>
  			<span class="nc">Collectors</span><span class="o">.</span><span class="na">mapping</span><span class="o">(</span><span class="nl">Student:</span><span class="o">:</span><span class="n">getName</span><span class="o">,</span> <span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">())</span>
  			<span class="c1">//첫 번째 매개변수는 어떤 걸 value값 선정할 건지, 두 번째 매개변수는 어떤 방식으로 저장할 건지</span>
  		<span class="o">)</span>
  	<span class="o">)</span>
</code></pre></div> </div> </li> <li> <p>그루핑 후 또 집계할 수 있게 두 번째 매개값으로 다음과 같은 Collector사용이 가능하다.</p> <ul> <li>Collectors.mapping(Function, Collector) : 매핑</li> <li>Collectors.averagingDouble(ToDoubleFuncton) : 평균값</li> <li>Collectors.counting() : 요소수</li> <li>Collectors.joining(…) : 문자 요소들을 연결</li> <li>Collectors.maxBy(Comparator) : 최대값</li> <li>Collectors.minBy(Comparator) : 최소값</li> <li>Collectors.reducing(…) : 커스텀 리덕션 값</li> <li>Collectors.summarrizingXXX(ToXXXFunction) : XXX 타입의 합계</li> </ul> </li> </ul> <p>**IntStream같은 경우 기본값이라 한 번 boxing이 필요하다.</p> <p><code class="language-plaintext highlighter-rouge">Stream.generate()</code> 팁 → 복권 번호 제조!</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Stream</span><span class="o">.</span><span class="na">generate</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">45</span><span class="o">)+</span><span class="mi">1</span><span class="o">)</span>
                <span class="o">.</span><span class="na">distinct</span><span class="o">()</span>
                <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
</code></pre></div></div> <p>ㅣ</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="https://qhals321.github.io/blog/java-basic/stream/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Dani </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://qhals321.github.io/assets/img/authors/Dani.png" alt="Dani" /> </div> <div class="col-md-6"> <p class="author_bio">많은 것을 배우고 싶은 사람</p> <p>Email : bomdani9302@gmail.com</p> <p>Website : https://qhals321.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/qhals321" target="_blank"><i class="fab fa-github fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "https://qhals321.github.io/blog/java-basic/stream/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/java-basic/자바기본-스트림"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About 다니</div> <div class="card-body"> <p class="author_bio">많은 것을 배우고 나누고싶은 사람</p><!-- Place this tag where you want the github button to render. --> <!--<a class="github-button" href="https://github.com/qhals321" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a>--> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#wua-techcourse"></div> <li class="tag-head"> <a href="/blog/categories/wua-techcourse">wua-techcourse</a> </li> <a name="wua-techcourse"></a> <div id="#java-basic"></div> <li class="tag-head"> <a href="/blog/categories/java-basic">java-basic</a> </li> <a name="java-basic"></a> <div id="#programming-etc"></div> <li class="tag-head"> <a href="/blog/categories/programming-etc">programming-etc</a> </li> <a name="programming-etc"></a> <div id="#book-review"></div> <li class="tag-head"> <a href="/blog/categories/book-review">book-review</a> </li> <a name="book-review"></a> <div id="#http"></div> <li class="tag-head"> <a href="/blog/categories/http">http</a> </li> <a name="http"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://qhals321.github.io/">Home</a> </li> <li> <a href="https://qhals321.github.io/about">About</a> </li> <li> <a href="https://qhals321.github.io/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <!--<form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>--> <!--<div id="mc_embed_signup_scroll_footer">--> <!-- <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label>--> <!-- <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required>--> <!-- &lt;!&ndash; real people should not fill this in and expect good things - do not remove this or risk form bot signups&ndash;&gt;--> <!-- <div style="position: absolute; left: -5000px;" aria-hidden="true">--> <!-- <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value="">--> <!-- </div><br />--> <!-- <div class="clear">--> <!-- <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success">--> <!-- </div>--> <!--</div>--> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://qhals321.github.io/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
